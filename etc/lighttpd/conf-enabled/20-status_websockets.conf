# Web sockets for detection of table change
# Timing.py will write the car number to these files
# we only care about a change

server.modules += ("mod_wstunnel")

wstunnel.server = (
  "/ws/status/newcar/" => (
    (
      "socket" => "/dev/shm/n_sock",
      "bin-path" => "/usr/bin/i_watcher /data/state_NewCar",
      "listen-backlog" => 4,
      "max-load-per-proc" => 4,
      "min-procs" => 7,
      "max-procs" => 10
    )
  ),
  "/ws/status/green/" => (
    (
      "socket" => "/dev/shm/g_sock",
      "bin-path" => "/usr/bin/i_watcher /data/state_Green",
      "listen-backlog" => 2,
      "max-load-per-proc" => 2,
      "min-procs" => 5,
      "max-procs" => 6
    )
  ),
  "/ws/status/start/" => (
    (
      "socket" => "/dev/shm/s_sock",
      "bin-path" => "/usr/bin/i_watcher /data/state_Start",
      "listen-backlog" => 2,
      "max-load-per-proc" => 2,
      "min-procs" => 5,
      "max-procs" => 6
    )
  ),
  "/ws/status/split/" => (
    (
      "socket" => "/dev/shm/s1_sock",
      "bin-path" => "/usr/bin/i_watcher /data/state_Split",
      "listen-backlog" => 2,
      "max-load-per-proc" => 2,
      "min-procs" => 5,
      "max-procs" => 6
    )
  ),
  "/ws/status/finish/" => (
    (
      "socket" => "/dev/shm/f_sock",
      "bin-path" => "/usr/bin/i_watcher /data/state_Finish",
      "listen-backlog" => 2,
      "max-load-per-proc" => 2,
      "min-procs" => 5,
      "max-procs" => 6
    )
  ),
  "/ws/debug/fake_buttons/" => (
    (
      "host" => "127.0.0.1",
      "port" => "399",
      "listen-backlog" => 2
    )
  )
)
